<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>قائمة الكاشير</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container">
  <h1>اختر السندويش</h1>

  <div class="text-center mb-3" id="sandwichButtons"></div>

  <h2>طلبك الحالي:</h2>
  <ul id="orderList"></ul>
  <h3 id="orderTotal">المجموع: 0 ليرة</h3>

  <button id="finishBtn" class="btn btn-success btn-lg d-block mx-auto my-4" 
          style="font-size: 28px; padding: 25px 60px; border-radius: 15px;" 
          onclick="finishOrder()">
    تم الدفع نقداً
  </button>
</div>

<script>
const WEBAPP_URL = "YOUR_WEBAPP_URL"; // ضع رابط الويب آب هنا

let prices = {
  'نقانق': 10000,
  'نقانق سمون': 15000,
  'بطاطا': 8000,
  'شيش': 12000,
  'شيش سمون': 18000
};

let orders = [];

function renderSandwichButtons() {
  const container = document.getElementById('sandwichButtons');
  container.innerHTML = '';
  Object.keys(prices).forEach(item => {
    let btn = document.createElement('button');
    btn.className = 'btn btn-outline-primary btn-lg m-2 px-4 py-3';
    btn.textContent = `${item} - ${prices[item]} ليرة`;
    btn.onclick = () => addOrder(item);
    container.appendChild(btn);
  });
}

function addOrder(item) {
  let existing = orders.find(o => o.item === item);
  if (existing) existing.qty++;
  else orders.push({item: item, qty: 1});
  updateOrderList();
}

function updateOrderList() {
  const list = document.getElementById('orderList');
  list.innerHTML = '';
  let total = 0;
  orders.forEach(order => {
    const li = document.createElement('li');
    li.textContent = `${order.item} × ${order.qty} - ${order.qty * prices[order.item]} ليرة`;
    list.appendChild(li);
    total += order.qty * prices[order.item];
  });
  document.getElementById('orderTotal').textContent = "المجموع: " + total + " ليرة";
}

function finishOrder() {
  if (orders.length === 0) { alert('لم يتم اختيار أي طلب!'); return; }

  let total = orders.reduce((sum, o) => sum + o.qty * prices[o.item], 0);
  let orderData = {
    id: Date.now(),
    items: orders,
    total: total,
    time: new Date().toLocaleString()
  };

  fetch(WEBAPP_URL, {
    method: "POST",
    body: JSON.stringify(orderData)
  })
  .then(res => res.text())
  .then(msg => {
    alert("تم إرسال الطلب للمطبخ ✅");
    orders = [];
    updateOrderList();
  })
  .catch(err => alert("Error: " + err));
}

renderSandwichButtons();
</script>
</body>
</html>
